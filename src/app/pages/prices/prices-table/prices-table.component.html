<table *ngIf="entries" class="table table-sm table-hover table-striped mb-0 table-responsive">
  <thead>
  <tr>
    <th *ngFor="let col of tableColumnHeaders" [colSpan]="col.colspan"
        [ngClass]="{'d-none': col.hideOnMd, 'd-md-table-cell': col.hideOnMd, 'w-100': col.fullWidth}">

      <ng-template #popContent>{{col.tooltip}}</ng-template>
      <div [ngbPopover]="popContent" triggers="mouseenter:mouseleave">
        <pw-sort-arrow (stateChange)="stateChange($event)" *ngIf="col.isSortable" [display]="col.display"
                       [id]="col.sortKey"
                       [reset]="resetSortArrows"></pw-sort-arrow>
        <span *ngIf="!col.isSortable">{{col.display}}</span>
      </div>

    </th>
  </tr>
  </thead>

  <tbody>
  <tr *ngFor="let item of entries">
    <td class="d-flex align-items-center justify-content-between">
      <pw-item [clickable]="true" [item]="item" [showImg]="true" [size]="'sm'"></pw-item>

      <ng-template #itemInfo>
        <div class="text-center">[WIP] External links for {{item.name}}</div>
        <hr class="my-2">
        <div class="row">
          <div class="col">
            <div class="small">Wiki link</div>
            <div class="small">Trade link 1</div>
            <div class="small">Trade link 2</div>
          </div>
          <div class="col">
            <a class="d-block small text-black-50" href="#">pathofexile.gamepedia.com</a>
            <a class="d-block small text-black-50" href="#">pathofexile.com/trade</a>
            <a class="d-block small text-black-50" href="#">poe.trade</a>
          </div>
        </div>
      </ng-template>


      <div class="mr-2">
        <div [autoClose]="'outside'" [ngbPopover]="itemInfo">
          <div class="colorbox custom-text-green-lo">?</div>
        </div>
      </div>


    </td>


    <td>
      <div class="pricebox-container">
        <div *ngIf="item.exalted >= 1 && item.id !== 142" [ngTemplateOutlet]="chaosPrice"></div>
        <div *ngIf="item.exalted >= 1 && item.id !== 142" [ngTemplateOutlet]="exaltedPrice"></div>

        <div *ngIf="item.exalted < 1" [ngTemplateOutlet]="exaltedPrice"></div>
        <div *ngIf="item.exalted < 1" [ngTemplateOutlet]="chaosPrice"></div>

        <div *ngIf="item.id === 142" [ngTemplateOutlet]="exaltedJoke"></div>
        <div *ngIf="item.id === 142" [ngTemplateOutlet]="chaosPrice"></div>

      </div>
    </td>

    <ng-template #chaosPrice>
      <div class="pricebox pw-subtext-1 font-weight-bold">
          <span class="img-container img-container-xs text-center mr-1">
            <img [src]="appConstants.CHAOS_ICON" alt="...">
          </span>
        {{item.mean | number:'1.0-2'}}
      </div>
    </ng-template>

    <ng-template #exaltedPrice>
      <div class="pricebox pw-subtext-1 font-weight-bold">
         <span class="img-container img-container-xs text-center mr-1">
            <img [src]="appConstants.EXALTED_ICON" alt="...">
          </span>
        {{item.exalted | number:'1.0-2'}}
      </div>
    </ng-template>

    <ng-template #exaltedJoke>
      <div class="pricebox pw-subtext-1 font-weight-bold">
          <span style="font-size: 10px">
            ah yes, 1 exalted is worth 1 exalted
          </span>
      </div>
    </ng-template>

    <td class="text-center p-0 nowrap">
      <div class="d-flex align-items-center">
        <pw-d3-spark [data]="item.history" [size]="[60, 30]"></pw-d3-spark>
      </div>
    </td>
    <td class="text-center p-0 nowrap">
      <span [style.color]="changeColor(item.change)" class="pw-subtext-1 font-weight-bold custom-text-gray-lo mx-2">
        {{item.change | number:'1.0-0'}}%
      </span>
    </td>
    <td class="text-center p-0">
      <span class="pw-subtext-1 font-weight-bold custom-text-gray-lo">
        {{item.current}}
      </span>
    </td>
    <td class="text-center p-0">
      <span [style.color]="dailyColor(capDaily(item))" class="pw-subtext-1 font-weight-bold custom-text-gray-lo">
        {{item.daily}}
      </span>
    </td>
    <td class="text-center p-0">
      <span class="pw-subtext-1 font-weight-bold custom-text-gray-lo">
        {{item.total}}
      </span>
    </td>
  </tr>
  </tbody>
</table>
